% Writing down FCMkIV "profile" data %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% SETUP %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass{article}

\usepackage[margin=.3in]{geometry} % Custom margins
\usepackage{multicol} % Use double columns

\newcommand{\dt}[1]{\dotfill \texttt{#1}}
\newcommand{\vp}{\vspace{1em}}
\newcommand{\el}{\textit{empty list}}
\newcommand{\et}{\textit{empty tuple}}
\newcommand{\es}{\textit{empty string}}

% DOCUMENT %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\textbf{\Large FCMkIV Profile Data Specification}
\vp

\hrule

\begin{multicols}{2}

\small

Attribute \hfill Default value

\begin{itemize}

\item \textbf{Core}

    \begin{itemize}
        \item Name\dt{"Unnamed FC Profile"}
        \item Description\dt{\es}
    \end{itemize}

\item \textbf{Runtime}

    \begin{itemize}
        \item Platform\dt{UNKNOWN \textit{(given at runtime)}}
        \item Print Queue\dt{\textit{mp.Queue (given at runtime)}}
    \end{itemize}

\item \textbf{Network}

    \begin{itemize}
    \item Broadcast port\dt{65000}
    \item Broadcast period (ms)\dt{1000}
    \item Broadcast period (s)\dt{\textit{get from ms}}
    \item Communication period (ms)\dt{100}
    \item Communication period (s)\dt{\textit{get from ms}}
    \item Max. message length (characters)\dt{512}
    \item Max. timeouts\dt{10}
    \vp
    \item Main queue size\dt{10}
    \item Slave queue size\dt{10}
    \item Broadcast queue size\dt{2}
    \item Listener queue size\dt{3}
    \item MISO queue size\dt{2}
    \item Printer queue size\dt{3}
    \item Passcode\dt{"CT"}
    \vp
    \item Default slave values (tuple)\dt{}
        \begin{itemize}
            \item Name\dt{"FAWT Module"}
            \item MAC\dt{\textit{Given by slave}}
            \item Index\dt{\textit{assigned automatically}}
            \vp
            \item Fan model\dt{"Unknown"}
            \item Fan mode\dt{SINGLE}
            \item Target relation (tuple)\dt{(1.0, 0.0)}
            \item Chaser tolerance (decimal for \%)\dt{0.02}
            \item Fan frequency (For PWM, in Hz)\dt{25000}
            \item Counter counts\dt{2}
            \item Counter timeout (ms)\dt{30}
            \item Pulses per rotation\dt{2}
            \item Max. RPM's (tuple, see fan mode)\dt{(16000)}
            \item Min. RPM's (tuple, see fan mode)\dt{(1200)}
            \item Min. DC's (tuple, see fan mode)\dt{(0.5)}
            \item Max. fans\dt{21}
            \item Max. fan timeouts\dt{1}
            \item Pinout (name as str)\dt{\textit{CAST pinout}}
        \end{itemize}
    \item Saved slaves (tuple tuple; see def. SV)\dt{\et}
    \item Pinouts (str (name) to str (code) dict.)
        \dt{\textit{built in}}
    \end{itemize}

\item \textbf{Fan Array}

    \begin{itemize}

    \item Default module rows\dt{0}
    \item Default module columns\dt{0}
    \item Default fan assignment\dt{\et}
    \vp
    \item Fan arrays (tuple)\dt{\et}
    \begin{itemize}
        \item Name\dt{"Unnamed fan array"}
        \item Description\dt{\es}
        \item Rows\dt{0}
        \item Columns\dt{0}
        \item Layers (fan mode)\dt{\textit{Def. fan mode}}
        \item Modules (tuple tuple)\dt{\et}
            \begin{itemize}
                \item Slave index\dt{-1}
                \item Row in array\dt{-1}
                \item Column in array\dt{-1}
                \item Number of rows\dt{0}
                \item Number of columns\dt{0}
                \item Number of fans\dt{0}
                \item Fan assignment (tuple tuple)\dt{\et}
            \end{itemize}
    \end{itemize}

    \end{itemize}

\end{itemize}

\end{multicols}
\vp
\hrule
\vp
\textbf{\large Notes}

\begin{itemize}
\item Profile data will be kept in memory as a Python dictionary, and
    distributed using deep copies.
\item In MkIV revisions that use the MkIII Communicator, the relevant
    parameters must be adjusted to be compatible with the MkIII Archiver.
\item Fan assignments are represented as tuples of tuples, where each inner
    tuple represents, as integers (fan indices) the fans that correspond to
    a particular grid cell. Grid cells may be empty (use an empty tuple), and
    the length of inner tuples must be consistent with the "fan mode" --- that
    is, they must be at most singletons for single fans and at most pairs for
    double fans.
    For example, the following is the fan assignment that corresponds to a
    module from the CAST wind tunnel:

    \texttt{((0, 1), (2, 3), (4, 5), (6, 7), (8, 9), (10, 11),
        (12, 13), (14, 15), (16, 17))}
\end{itemize}

\end{document}
